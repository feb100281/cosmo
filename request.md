# Выгрузка данных из 1С для аналитической базы

## Введение

Как обсуждалось на последнем звонке, задачи по аналитике, планированию, управленческому учету и автоматизации значительно проще решать через создание отдельной аналитической базы данных.  
Эта база будет собирать и обрабатывать данные из следующих источников:

- 1С
- Excel-расчеты
- Веб-аналитика
- Оперативные данные, не фиксируемые в 1С

## Ключевые данные из 1С

В части продаж ключевыми являются:

1. Справочники номенклатуры  
2. Данные о продажах и возвратах

Для удобства аналитики желательно разбить выгрузку на отдельные CSV-файлы с ежедневным обновлением.

---

## 1. Справочник номенклатуры

**Формат:** CSV  
**Обязательные поля:**

- `id` — уникальный идентификатор в 1С (**обязательно**)
- Наименование
- Артикул
- Прочие атрибуты (при наличии)

---

## 2. Магазины / Торговые точки

**Формат:** CSV  
**Обязательные поля:**

- `id` — уникальный идентификатор в 1С (**обязательно**)
- Наименование
- Прочие поля (при необходимости)

---

## 3. Заказы

**Формат:** CSV  
**Обязательные поля:**

- `id` — уникальный идентификатор в 1С (**обязательно**)
- Дата
- Номер заказа
- `id_магазина` — ссылка на магазин
- Статус: "оплачен" / "не оплачен" или только оплаченные
- Прочие поля

---

## 4. Чеки

**Формат:** CSV  
**Обязательные поля:**

- `id` — уникальный идентификатор в 1С (**обязательно**)
- Дата
- Номер чека
- `id_магазина`
- Тип чека: "продажа" / "возврат"
- Прочие поля

---

## 5. Состав заказов (Заказы_Номенклатура)

**Формат:** CSV  
**Поля:**

- `id_заказа`
- `id_номенклатуры`
- Характеристики номенклатуры
- Количество
- Цена или сумма

---

## 6. Состав чеков (Чеки_Номенклатура)

**Формат:** CSV  
**Поля:**

- `id_чека`
- `id_номенклатуры`
- Характеристики номенклатуры
- Количество
- Цена или сумма

---

## Альтернативный вариант


Если реализация описанной структуры затруднительна, можно ограничиться одной сводной выгрузкой в CSV или отчётом с большим количеством полей.  
В этом случае нормализацию и структурирование можно будет выполнить вручную, но это ограничит возможности автоматизации и интеграции с 1С.

## Дальнейшая работа
Такая база способна поддерживать множество структур и практически неограниченный функционал.
В ближайшее время я разверну базу данных и небольшое приложение на Django на тестовом сервере и покажу, какие возможности даёт предлагаемая структура.

Данный подход хорошо масштабируется и может стать основой для полноценной системы управленческого учёта и аналитики не только по продажам.

Имея обновляемые справочники по номенклатуре и продажам, можно приступить к построению аналитической модели. Основные направления работы:

1. **Формирование витрины продаж**
   - Свод по датам, магазинам и номенклатуре
   - Анализ динамики продаж по товарам и категориям
   - Сравнение продаж и возвратов
   - Создание матриц (динамически)

2. **Интеграция с внешними источниками**
   - Добавление расчетных данных из Excel (например, планов или целевых показателей)
   - Сопоставление с веб-аналитикой (посешаемость)   

3. **Построение отчетов и визуализаций**
   - Дашборды по ключевым метрикам (выручка, средний чек, возвраты и др.)
   - Отчёты по категориям товаров, магазинам, продавцам и т.д.

5. **План-факт анализ**
   - Сравнение фактических продаж с плановыми значениями
   - Выявление отклонений и ключевых факторов влияния

6. **Подготовка к расширенной аналитике**
   - Анализ сезонности и трендов
   - Построение прогностических моделей
   - Расчет метрик 

---

